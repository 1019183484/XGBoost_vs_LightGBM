
{'n_clusters_per_class': 8, 'n_train': 100000, 'max_depth': 5}
training xgboost - cpu tree construction
XGBoost CPU: 20.8994169235 seconds
training xgboost - gpu tree construction
required: 113072128
trying to allocate: 113043200
XGBoost GPU: 7.34045219421 seconds
training LightGBM
LightGBM: 0.728410959244 seconds

logloss train
     XGB_CPU   XGB_GPU      LGBM
0   0.671586  0.671584  0.671336
15  0.522825  0.523122  0.524626
30  0.469023  0.469361  0.476507
45  0.439034  0.441048  0.446472

logloss valid
     XGB_CPU   XGB_GPU      LGBM
0   0.671967  0.671965  0.671679
15  0.527712  0.527902  0.529014
30  0.476642  0.476996  0.483087
45  0.449472  0.451352  0.455545

Leaf counts
    XGB_CPU  XGB_GPU  LGBM
0        32       32    32
15       32       32    32
30       32       32    32
45       32       29    32

Feature importance sorted by XGB_CPU
      XGB_CPU   XGB_GPU      LGBM
f15  0.103430  0.102398  0.123230
f9   0.092019  0.094675  0.070025
f14  0.083578  0.076799  0.111131
f13  0.076586  0.073864  0.073813
f0   0.057198  0.055872  0.055211

{'n_clusters_per_class': 8, 'n_train': 100000, 'max_depth': 10}
training xgboost - cpu tree construction
XGBoost CPU: 37.8232989311 seconds
training xgboost - gpu tree construction
required: 115310080
trying to allocate: 114360576
XGBoost GPU: 9.12014818192 seconds
training LightGBM
LightGBM: 1.84302902222 seconds

logloss train
     XGB_CPU   XGB_GPU      LGBM
0   0.650310  0.650314  0.650332
15  0.367306  0.367525  0.370997
30  0.274696  0.277406  0.280490
45  0.234705  0.235801  0.239343

logloss valid
     XGB_CPU   XGB_GPU      LGBM
0   0.654511  0.654550  0.654536
15  0.411447  0.412111  0.413251
30  0.339243  0.341768  0.342690
45  0.309999  0.311185  0.312509

Leaf counts
    XGB_CPU  XGB_GPU  LGBM
0       767      748   801
15      663      636   642
30      624      527   682
45      437      294   275

Feature importance sorted by XGB_CPU
      XGB_CPU   XGB_GPU      LGBM
f15  0.109021  0.107788  0.088996
f13  0.073199  0.074124  0.073685
f14  0.072013  0.072192  0.080292
f9   0.061181  0.059665  0.044646
f4   0.050442  0.051221  0.066043

{'n_clusters_per_class': 8, 'n_train': 100000, 'max_depth': 15}
training xgboost - cpu tree construction
XGBoost CPU: 53.8864779472 seconds
training xgboost - gpu tree construction
required: 186924544
trying to allocate: 156516608
XGBoost GPU: 11.6765089035 seconds
training LightGBM
LightGBM: 13.8986611366 seconds

logloss train
     XGB_CPU   XGB_GPU      LGBM
0   0.630902  0.631823  0.632185
15  0.238004  0.240930  0.242819
30  0.135424  0.137711  0.138688
45  0.095779  0.093131  0.094171

logloss valid
     XGB_CPU   XGB_GPU      LGBM
0   0.645188  0.645411  0.645732
15  0.361200  0.363355  0.360857
30  0.291896  0.293549  0.291273
45  0.266687  0.266044  0.264265

Leaf counts
    XGB_CPU  XGB_GPU  LGBM
0      3580     3216  3550
15     2794     2719  2824
30     2093     1990  1992
45     1077     1038  1047

Feature importance sorted by XGB_CPU
      XGB_CPU   XGB_GPU      LGBM
f15  0.095595  0.099051  0.080979
f13  0.068925  0.069582  0.067935
f14  0.063780  0.064769  0.073246
f9   0.049572  0.045344  0.039637
f4   0.048694  0.049431  0.060406

{'n_clusters_per_class': 64, 'n_train': 100000, 'max_depth': 5}
training xgboost - cpu tree construction
XGBoost CPU: 20.1664459705 seconds
training xgboost - gpu tree construction
required: 113072128
trying to allocate: 113043200
XGBoost GPU: 6.85860490799 seconds
training LightGBM
LightGBM: 0.729791164398 seconds

logloss train
     XGB_CPU   XGB_GPU      LGBM
0   0.688764  0.688763  0.688874
15  0.657472  0.657602  0.658127
30  0.643924  0.643089  0.644987
45  0.635336  0.635565  0.635831

logloss valid
     XGB_CPU   XGB_GPU      LGBM
0   0.689180  0.689176  0.689214
15  0.662667  0.662765  0.663049
30  0.652902  0.652283  0.653502
45  0.647456  0.647581  0.647474

Leaf counts
    XGB_CPU  XGB_GPU  LGBM
0        32       32    32
15       32       32    32
30       32       30    31
45       32       26    32

Feature importance sorted by XGB_CPU
      XGB_CPU   XGB_GPU      LGBM
f20  0.103799  0.099547  0.139880
f2   0.092117  0.088798  0.077797
f5   0.055530  0.058425  0.080272
f1   0.055090  0.059635  0.049607
f4   0.052772  0.052998  0.045240

{'n_clusters_per_class': 64, 'n_train': 100000, 'max_depth': 10}
training xgboost - cpu tree construction
XGBoost CPU: 37.548238039 seconds
training xgboost - gpu tree construction
required: 115310080
trying to allocate: 114360576
XGBoost GPU: 8.92156887054 seconds
training LightGBM
LightGBM: 1.78978681564 seconds

logloss train
     XGB_CPU   XGB_GPU      LGBM
0   0.678482  0.678610  0.678615
15  0.558957  0.558437  0.558661
30  0.511111  0.510170  0.506637
45  0.487626  0.488106  0.482564

logloss valid
     XGB_CPU   XGB_GPU      LGBM
0   0.684202  0.684198  0.684217
15  0.624087  0.624138  0.623728
30  0.606695  0.606461  0.604276
45  0.601615  0.601550  0.599454

Leaf counts
    XGB_CPU  XGB_GPU  LGBM
0       823      808   855
15      666      683   680
30      595      240   314
45      340      331   291

Feature importance sorted by XGB_CPU
      XGB_CPU   XGB_GPU      LGBM
f20  0.065066  0.063720  0.061578
f2   0.049967  0.049942  0.046274
f5   0.049566  0.048961  0.050545
f1   0.042869  0.042057  0.036458
f27  0.042578  0.044444  0.066942

{'n_clusters_per_class': 64, 'n_train': 100000, 'max_depth': 15}
training xgboost - cpu tree construction
XGBoost CPU: 54.9189209938 seconds
training xgboost - gpu tree construction
required: 186924544
trying to allocate: 156516608
XGBoost GPU: 11.5630879402 seconds
training LightGBM
LightGBM: 15.0544428825 seconds

logloss train
     XGB_CPU   XGB_GPU      LGBM
0   0.657352  0.658475  0.658069
15  0.384391  0.388813  0.380991
30  0.289232  0.296526  0.285539
45  0.258044  0.269648  0.247115

logloss valid
     XGB_CPU   XGB_GPU      LGBM
0   0.681261  0.681348  0.680996
15  0.606831  0.608242  0.606465
30  0.587091  0.587822  0.585877
45  0.581966  0.583401  0.579284

Leaf counts
    XGB_CPU  XGB_GPU  LGBM
0      4805     4513  4748
15     3512     2555  3603
30     2563     1524  1443
45      297     1296  1063

Feature importance sorted by XGB_CPU
      XGB_CPU   XGB_GPU      LGBM
f20  0.048364  0.048868  0.048822
f27  0.042891  0.042343  0.054034
f2   0.042450  0.041246  0.040382
f5   0.042145  0.042552  0.041642
f0   0.039485  0.038999  0.039031

{'n_clusters_per_class': 8, 'n_train': 1000000, 'max_depth': 5}
training xgboost - cpu tree construction
XGBoost CPU: 178.510592937 seconds
training xgboost - gpu tree construction
required: 1130072128
trying to allocate: 1130043136
XGBoost GPU: 29.4626529217 seconds
training LightGBM
LightGBM: 3.16092205048 seconds

logloss train
     XGB_CPU   XGB_GPU      LGBM
0   0.670728  0.670726  0.670727
15  0.509709  0.509709  0.510868
30  0.450558  0.450558  0.452358
45  0.420399  0.421128  0.420231

logloss valid
     XGB_CPU   XGB_GPU      LGBM
0   0.670890  0.670886  0.670877
15  0.511114  0.511097  0.512195
30  0.452804  0.452784  0.454434
45  0.423213  0.423840  0.422763

Leaf counts
    XGB_CPU  XGB_GPU  LGBM
0        32       32    32
15       32       32    32
30       32       32    32
45       32       32    32

Feature importance sorted by XGB_CPU
      XGB_CPU   XGB_GPU      LGBM
f13  0.224652  0.234451  0.128329
f15  0.071736  0.068947  0.078335
f17  0.055290  0.055943  0.071837
f25  0.052169  0.051660  0.053096
f24  0.051801  0.048663  0.046637

{'n_clusters_per_class': 8, 'n_train': 1000000, 'max_depth': 10}
training xgboost - cpu tree construction
XGBoost CPU: 362.350599051 seconds
training xgboost - gpu tree construction
required: 1132310080
trying to allocate: 1131360512
XGBoost GPU: 43.9174849987 seconds
training LightGBM
LightGBM: 8.9747710228 seconds

logloss train
     XGB_CPU   XGB_GPU      LGBM
0   0.650882  0.650858  0.650948
15  0.365596  0.368710  0.368363
30  0.282638  0.289254  0.284898
45  0.254415  0.253827  0.251932

logloss valid
     XGB_CPU   XGB_GPU      LGBM
0   0.651611  0.651589  0.651530
15  0.374535  0.377551  0.376305
30  0.296450  0.302834  0.297519
45  0.270957  0.270421  0.267389

Leaf counts
    XGB_CPU  XGB_GPU  LGBM
0       942      931   959
15      948      888   920
30      829      726   800
45      465      660   810

Feature importance sorted by XGB_CPU
      XGB_CPU   XGB_GPU      LGBM
f13  0.143455  0.146402  0.097213
f25  0.065901  0.065914  0.047350
f17  0.065785  0.068029  0.057225
f15  0.063968  0.062934  0.073848
f24  0.055084  0.052646  0.044607

{'n_clusters_per_class': 8, 'n_train': 1000000, 'max_depth': 15}
training xgboost - cpu tree construction
XGBoost CPU: 561.592586994 seconds
training xgboost - gpu tree construction
required: 1203924544
trying to allocate: 1173516544
XGBoost GPU: 57.0815310478 seconds
training LightGBM
LightGBM: 47.24538517 seconds

logloss train
     XGB_CPU   XGB_GPU      LGBM
0   0.633001  0.633176  0.633490
15  0.256533  0.258194  0.259383
30  0.164238  0.168599  0.167097
45  0.131443  0.132800  0.135806

logloss valid
     XGB_CPU   XGB_GPU      LGBM
0   0.637114  0.637176  0.637244
15  0.298483  0.299775  0.298483
30  0.221791  0.224962  0.221653
45  0.196851  0.197635  0.198197

Leaf counts
    XGB_CPU  XGB_GPU  LGBM
0      8692     8039  8732
15     9284     8790  7841
30     6848     5635  5248
45     1949     5068  2840

Feature importance sorted by XGB_CPU
      XGB_CPU   XGB_GPU      LGBM
f13  0.118581  0.117791  0.086151
f17  0.063914  0.064121  0.054723
f15  0.061209  0.062280  0.073378
f25  0.059103  0.059630  0.046324
f19  0.054001  0.053123  0.060854

{'n_clusters_per_class': 64, 'n_train': 1000000, 'max_depth': 5}
training xgboost - cpu tree construction
XGBoost CPU: 177.140831947 seconds
training xgboost - gpu tree construction
required: 1130072128
trying to allocate: 1130043136
XGBoost GPU: 29.3804051876 seconds
training LightGBM
LightGBM: 3.04504489899 seconds

logloss train
     XGB_CPU   XGB_GPU      LGBM
0   0.689311  0.689310  0.689340
15  0.661580  0.661410  0.661816
30  0.649658  0.649784  0.650456
45  0.643334  0.643654  0.644234

logloss valid
     XGB_CPU   XGB_GPU      LGBM
0   0.689349  0.689347  0.689376
15  0.662405  0.662193  0.662551
30  0.651146  0.651180  0.651779
45  0.645317  0.645571  0.646001

Leaf counts
    XGB_CPU  XGB_GPU  LGBM
0        32       32    32
15       32       32    32
30       32       32    32
45       32       32    32

Feature importance sorted by XGB_CPU
      XGB_CPU   XGB_GPU      LGBM
f1   0.115456  0.121043  0.146366
f20  0.078669  0.069871  0.087861
f24  0.073573  0.079660  0.077634
f10  0.066363  0.062025  0.041523
f4   0.057867  0.058877  0.057452

{'n_clusters_per_class': 64, 'n_train': 1000000, 'max_depth': 10}
training xgboost - cpu tree construction
XGBoost CPU: 370.388036013 seconds
training xgboost - gpu tree construction
required: 1132310080
trying to allocate: 1131360512
XGBoost GPU: 43.4839301109 seconds
training LightGBM
LightGBM: 7.92586302757 seconds

logloss train
     XGB_CPU   XGB_GPU      LGBM
0   0.683261  0.683298  0.683379
15  0.606329  0.606615  0.607313
30  0.573133  0.573427  0.575052
45  0.560136  0.559943  0.561704

logloss valid
     XGB_CPU   XGB_GPU      LGBM
0   0.684198  0.684242  0.684218
15  0.617960  0.618260  0.618214
30  0.592484  0.592661  0.593131
45  0.583365  0.583286  0.583671

Leaf counts
    XGB_CPU  XGB_GPU  LGBM
0       976      975   970
15      897      941   965
30      790      702   599
45      746      546   566

Feature importance sorted by XGB_CPU
      XGB_CPU   XGB_GPU      LGBM
f1   0.079450  0.079303  0.083116
f20  0.067664  0.067857  0.058793
f24  0.052675  0.051694  0.056330
f2   0.051429  0.050032  0.080884
f4   0.051219  0.051314  0.041949

{'n_clusters_per_class': 64, 'n_train': 1000000, 'max_depth': 15}
training xgboost - cpu tree construction
XGBoost CPU: 560.140439987 seconds
training xgboost - gpu tree construction
required: 1203924544
trying to allocate: 1173516544
XGBoost GPU: 57.8424508572 seconds
training LightGBM
LightGBM: 55.8032491207 seconds

logloss train
     XGB_CPU   XGB_GPU      LGBM
0   0.670090  0.670446  0.670465
15  0.485605  0.486778  0.489200
30  0.409078  0.410954  0.413142
45  0.382433  0.387212  0.387483

logloss valid
     XGB_CPU   XGB_GPU      LGBM
0   0.677555  0.677618  0.677562
15  0.569222  0.569565  0.569798
30  0.534370  0.535370  0.535158
45  0.522234  0.524425  0.523167

Leaf counts
    XGB_CPU  XGB_GPU   LGBM
0     13558    12855  13270
15    11087    10997  11036
30     7475     8194   6224
45     1744     4188   1819

Feature importance sorted by XGB_CPU
      XGB_CPU   XGB_GPU      LGBM
f1   0.054210  0.055556  0.058574
f20  0.049073  0.049372  0.044939
f2   0.047719  0.048703  0.070462
f8   0.046268  0.045697  0.057386
f19  0.045979  0.046676  0.059888

{'n_clusters_per_class': 8, 'n_train': 10000000, 'max_depth': 5}
training xgboost - cpu tree construction
XGBoost CPU: 1973.05493307 seconds
training xgboost - gpu tree construction
required: 11300072128
trying to allocate: 7379907584
XGBoost GPU: 234.360874176 seconds
training LightGBM
LightGBM: 27.3067550659 seconds

logloss train
     XGB_CPU   XGB_GPU      LGBM
0   0.669987  0.670323  0.670019
15  0.517307  0.519477  0.518450
30  0.467447  0.471793  0.468278
45  0.442885  0.449068  0.443174

logloss valid
     XGB_CPU   XGB_GPU      LGBM
0   0.670017  0.670328  0.670027
15  0.517657  0.519861  0.518811
30  0.468056  0.472359  0.468760
45  0.443612  0.449693  0.443735

Leaf counts
    XGB_CPU  XGB_GPU  LGBM
0        32       32    32
15       32       32    32
30       32       32    32
45       32       32    32

Feature importance sorted by XGB_CPU
      XGB_CPU   XGB_GPU      LGBM
f6   0.116426  0.115416  0.141937
f18  0.084441  0.084039  0.057610
f9   0.082558  0.084653  0.138230
f24  0.070133  0.073397  0.072209
f27  0.069240  0.064812  0.089200

{'n_clusters_per_class': 8, 'n_train': 10000000, 'max_depth': 10}
training xgboost - cpu tree construction
XGBoost CPU: 4229.91957116 seconds
training xgboost - gpu tree construction
required: 11302310080
trying to allocate: 7381224960
XGBoost GPU: 366.575484991 seconds
training LightGBM
LightGBM: 76.1379859447 seconds

logloss train
     XGB_CPU   XGB_GPU      LGBM
0   0.651501  0.651323  0.651506
15  0.389861  0.389997  0.389585
30  0.315746  0.317394  0.314544
45  0.285297  0.286135  0.284229

logloss valid
     XGB_CPU   XGB_GPU      LGBM
0   0.651631  0.651475  0.651627
15  0.391741  0.391615  0.391085
30  0.318695  0.319878  0.317076
45  0.288891  0.289228  0.287252

Leaf counts
    XGB_CPU  XGB_GPU  LGBM
0      1013     1002  1013
15     1017      997  1017
30      943      884   905
45      931      705  1002

Feature importance sorted by XGB_CPU
      XGB_CPU   XGB_GPU      LGBM
f6   0.112811  0.109040  0.102947
f18  0.088702  0.083610  0.049780
f9   0.071372  0.071723  0.110813
f19  0.058332  0.059205  0.065200
f24  0.058261  0.058180  0.065818

{'n_clusters_per_class': 8, 'n_train': 10000000, 'max_depth': 15}
training xgboost - cpu tree construction
XGBoost CPU: 6795.73056889 seconds
training xgboost - gpu tree construction
required: 11373924544
trying to allocate: 7423380992
XGBoost GPU: 486.77848506 seconds
training LightGBM
LightGBM: 217.65976882 seconds

logloss train
     XGB_CPU   XGB_GPU      LGBM
0   0.635147  0.635325  0.635206
15  0.285674  0.289470  0.287020
30  0.201172  0.206775  0.202874
45  0.169311  0.177221  0.172556

logloss valid
     XGB_CPU   XGB_GPU      LGBM
0   0.636277  0.636393  0.636245
15  0.297326  0.299586  0.297678
30  0.218809  0.221759  0.219032
45  0.190752  0.195110  0.192315

Leaf counts
    XGB_CPU  XGB_GPU   LGBM
0     18778    16596  18921
15    18734    16294  18861
30    17020    10676  12422
45     6901     5999   7615

Feature importance sorted by XGB_CPU
      XGB_CPU   XGB_GPU      LGBM
f6   0.104366  0.094449  0.092331
f9   0.078141  0.078209  0.107030
f18  0.072575  0.070656  0.043939
f19  0.061328  0.060401  0.065851
f24  0.058508  0.060501  0.065714

{'n_clusters_per_class': 64, 'n_train': 10000000, 'max_depth': 5}
training xgboost - cpu tree construction
XGBoost CPU: 1942.74801803 seconds
training xgboost - gpu tree construction
required: 11300072128
trying to allocate: 7379907584
XGBoost GPU: 233.350553989 seconds
training LightGBM
LightGBM: 26.8200759888 seconds

logloss train
     XGB_CPU   XGB_GPU      LGBM
0   0.689049  0.689214  0.689055
15  0.660766  0.662006  0.660490
30  0.650612  0.651216  0.650211
45  0.644898  0.645993  0.644815

logloss valid
     XGB_CPU   XGB_GPU      LGBM
0   0.689063  0.689198  0.689058
15  0.660698  0.661897  0.660394
30  0.650587  0.651157  0.650100
45  0.644950  0.645993  0.644780

Leaf counts
    XGB_CPU  XGB_GPU  LGBM
0        32       32    32
15       32       32    32
30       32       32    32
45       32       32    32

Feature importance sorted by XGB_CPU
      XGB_CPU   XGB_GPU      LGBM
f2   0.146784  0.136057  0.138844
f13  0.069520  0.081304  0.081796
f4   0.060379  0.060524  0.056287
f7   0.055734  0.051688  0.072585
f19  0.055316  0.053294  0.078087

{'n_clusters_per_class': 64, 'n_train': 10000000, 'max_depth': 10}
training xgboost - cpu tree construction
XGBoost CPU: 4255.14379501 seconds
training xgboost - gpu tree construction
required: 11302310080
trying to allocate: 7381224960
XGBoost GPU: 364.00453496 seconds
training LightGBM
LightGBM: 72.3975908756 seconds

logloss train
     XGB_CPU   XGB_GPU      LGBM
0   0.682894  0.683029  0.682954
15  0.607277  0.609032  0.607624
30  0.577403  0.581636  0.578770
45  0.565917  0.569353  0.564491

logloss valid
     XGB_CPU   XGB_GPU      LGBM
0   0.683044  0.683128  0.683053
15  0.609519  0.610962  0.609435
30  0.581080  0.584733  0.581694
45  0.570484  0.573315  0.568431

Leaf counts
    XGB_CPU  XGB_GPU  LGBM
0      1024     1000  1024
15     1001     1006  1003
30     1015      919  1004
45      580      923   878

Feature importance sorted by XGB_CPU
      XGB_CPU   XGB_GPU      LGBM
f2   0.103167  0.096246  0.071413
f19  0.057211  0.056322  0.072503
f13  0.055980  0.061802  0.057912
f24  0.055504  0.054546  0.073286
f7   0.055499  0.059922  0.067103

{'n_clusters_per_class': 64, 'n_train': 10000000, 'max_depth': 15}
training xgboost - cpu tree construction
XGBoost CPU: 6792.20055699 seconds
training xgboost - gpu tree construction
required: 11373924544
trying to allocate: 7423380992
XGBoost GPU: 489.340021133 seconds
training LightGBM
LightGBM: 233.371381998 seconds

logloss train
     XGB_CPU   XGB_GPU      LGBM
0   0.672482  0.673076  0.672633
15  0.519629  0.525597  0.521100
30  0.462941  0.472453  0.465597
45  0.437447  0.450484  0.441108

logloss valid
     XGB_CPU   XGB_GPU      LGBM
0   0.674288  0.674565  0.674281
15  0.540653  0.543516  0.540736
30  0.495743  0.500089  0.496266
45  0.476712  0.483164  0.477932

Leaf counts
    XGB_CPU  XGB_GPU   LGBM
0     25323    21711  25409
15    22291    20930  21900
30    16452    14182  18641
45     4957    11229  13794

Feature importance sorted by XGB_CPU
      XGB_CPU   XGB_GPU      LGBM
f2   0.064998  0.060543  0.049762
f11  0.056342  0.056299  0.087048
f19  0.054733  0.053667  0.066759
f7   0.053975  0.053226  0.062201
f24  0.053788  0.052161  0.068377


Time
                                         XGB_CPU  XGB_GPU   LGBM
n_train  n_clusters_per_class max_depth                         
100000   8                    5             20.9      7.3    0.7
                              10            37.8      9.1    1.8
                              15            53.9     11.7   13.9
         64                   5             20.2      6.9    0.7
                              10            37.5      8.9    1.8
                              15            54.9     11.6   15.1
1000000  8                    5            178.5     29.5    3.2
                              10           362.4     43.9    9.0
                              15           561.6     57.1   47.2
         64                   5            177.1     29.4    3.0
                              10           370.4     43.5    7.9
                              15           560.1     57.8   55.8
10000000 8                    5           1973.1    234.4   27.3
                              10          4229.9    366.6   76.1
                              15          6795.7    486.8  217.7
         64                   5           1942.7    233.4   26.8
                              10          4255.1    364.0   72.4
                              15          6792.2    489.3  233.4

Done: 32055.524188 seconds
